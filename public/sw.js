const CACHE='blokus-grid-v1';self.addEventListener('install',e=>self.skipWaiting());self.addEventListener('activate',e=>{e.waitUntil((async()=>{const k=await caches.keys();await Promise.all(k.filter(x=>x!==CACHE).map(x=>caches.delete(x)));await self.clients.claim();})())});self.addEventListener('fetch',e=>{const r=e.request;if(r.method!=='GET')return;const u=new URL(r.url);if(r.mode==='navigate'){e.respondWith((async()=>{try{return await fetch(r)}catch(e){return(await caches.match('/index.html'))||(await caches.match('index.html'))||Response.error()}})());return}if(u.origin===location.origin){e.respondWith((async()=>{const c=await caches.match(r);if(c)return c;try{const f=await fetch(r),copy=f.clone(),cache=await caches.open(CACHE);cache.put(r,copy);return f}catch(e){return c||Response.error()}})())}});
